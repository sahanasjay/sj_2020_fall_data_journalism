---
title: "data_analysis_01"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

```{r}
# install.packages("sf")

library(tidyverse)
library(sf)
library(lubridate)
options(scipen = 999)
```


Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
```{r}
streetracing <-read_csv("data/street-racing-fatalities.csv")
fatalities <-read_csv("data/fatalities.csv")
citypop <- st_read("data/hoods.shp")%>%
  as_tibble()%>%
  select(-geometry)

```


```{r}
fatalities_truncated <- fatalities%>%
  select(name, city, death_datetime, death_year)

fatalities_truncated
```
```{r}
commerce_deaths <-fatalities_truncated%>%
  filter(name == "Commerce", death_year >= "2000")

commerce_deaths

```
```{r}
death_by_city <- fatalities_truncated%>%
  group_by(name)%>%
  summarise(city_deaths = n())%>%
  arrange(desc(city_deaths))

death_by_city
```
```{r}
# This code joins the citypop table we created with the death by city frame and then creates a new column dividing the number of deaths per city by the population (multiplying by 10,000) and then filters out any cities with populations less than a thousand, generating the 4th finding: Deaths have occurred all across L.A. County, with the biggest concentration in the small city of Commerce. Eleven have died on the small, industrial cityâ€™s streets since 2000.

death_by_city_pop <- death_by_city%>%
 inner_join(citypop)%>%
  mutate(deaths_per_capita = (city_deaths/population*10000))%>%
  filter(population > 1000)%>%
  arrange(desc(deaths_per_capita))


death_by_city_pop

```

```{r}
deaths_by_year <- streetracing%>%
  mutate(year = year(DeathDateTime))%>%
  select(year,everything())
 
deaths_by_year

```
```{r}
none <-streetracing%>%
  anti_join(fatalities,by = c("CaseNum"="case_number"))


none
```
